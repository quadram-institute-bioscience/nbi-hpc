import{d as N,E as T,O as z,D as I,r as E,f,n as k,z as C,g as u,t as y,o as x,p as F,e as P,C as V,F as A,ad as R,ag as K,ae as j,k as B}from"../modules/vue-Cqa0Mq5Y.js";import{C as H,r as q,v as O,_ as U}from"../index-DsnPPmCT.js";import{m as X}from"../modules/unplugin-icons-DaKupcfE.js";const G=["innerHTML"],J=["textContent"],Q=["textContent"],S="slidev-note-fade",b="slidev-note-click-mark",re=N({__name:"NoteDisplay",props:{class:{},noteHtml:{},note:{},highlight:{type:Boolean,default:!0},placeholder:{},clicksContext:{},autoScroll:{type:Boolean}},emits:["markerDblclick","markerClick"],setup(c,{emit:v}){const t=c,g=v,p=C(()=>{var d;return t.clicksContext!=null&&((d=t.noteHtml)==null?void 0:d.includes("slidev-note-click-mark"))}),n=E(null);function w(){var $,D;if(!n.value||!p.value)return;const d=Array.from(n.value.querySelectorAll(`.${b}`)),s=new Map,m=new Map;let a=0;for(const i of d){const l=Number(i.dataset.clicks);s.set(i,l);let o=i,e=i.parentElement;for(;e&&o!==n.value;)m.has(e)||m.set(e,[[null,a]]),m.get(e).push([o,l]),o=e,e=e.parentElement;a=l}const _=new Map;for(const[i,l]of m){let o=!1,e=0;for(const r of Array.from(i.childNodes)){let M=!1;for(;r===(($=l[e+1])==null?void 0:$[0]);)M=!0,e++;if(M)continue;let L=r;if(r.nodeType===3){if(!((D=r.textContent)!=null&&D.trim()))continue;L=document.createElement("span"),L.textContent=r.textContent,i.insertBefore(L,r),r.remove()}o||(o=e===0),_.set(L,l[e][1])}o||(l[0][1]=-1)}return i=>{const l=t.highlight;for(const[o,e]of m)o.classList.toggle(S,l&&!e.some(([r,M])=>M===i));for(const[o,e]of _)o.classList.toggle(S,l&&e!==i);for(const[o,e]of s)o.classList.remove(S),o.classList.toggle(`${b}-past`,l&&e<i),o.classList.toggle(`${b}-active`,l&&e===i),o.classList.toggle(`${b}-next`,l&&e===i+1),o.classList.toggle(`${b}-future`,l&&e>i+1),o.ondblclick=l?r=>{g("markerDblclick",r,e),!r.defaultPrevented&&(t.clicksContext.current=e,r.stopPropagation(),r.stopImmediatePropagation())}:null,o.onclick=l?r=>{g("markerClick",r,e)}:null,l&&t.autoScroll&&e===i&&o.scrollIntoView({block:"center",behavior:"smooth"})}}const h=E();return T(()=>[t.noteHtml,t.highlight],()=>{F(()=>{h.value=w()})},{immediate:!0}),z(()=>{w()}),I(()=>{var s,m;const d=((s=t.clicksContext)==null?void 0:s.current)??H;(m=h.value)==null||m.call(h,d)}),(d,s)=>c.noteHtml?(x(),f("div",{key:0,ref_key:"noteDisplay",ref:n,class:k(["prose overflow-auto outline-none slidev-note",[t.class,p.value?"slidev-note-with-clicks":""]]),innerHTML:c.noteHtml},null,10,G)):c.note?(x(),f("div",{key:1,class:k(["prose overflow-auto outline-none slidev-note",t.class])},[u("p",{textContent:y(c.note)},null,8,J)],2)):(x(),f("div",{key:2,class:k(["prose overflow-auto outline-none opacity-50 italic select-none slidev-note",t.class])},[u("p",{textContent:y(t.placeholder||"No notes.")},null,8,Q)],2))}}),W=["title"],Y={class:"flex gap-0.2 items-center min-w-16 font-mono mr1"},Z={"text-primary":""},ee={op50:"","text-sm":""},te={key:1,op50:"","flex-auto":"",pl1:""},oe={relative:"","flex-auto":"",h5:"","font-mono":"",flex:"~"},le=["min","max"],ne=N({__name:"ClicksSlider",props:{clicksContext:{},readonly:{type:Boolean},active:{type:Boolean,default:!0}},setup(c){const v=c,t=C(()=>v.clicksContext.total),g=C(()=>q(0,v.clicksContext.clicksStart,t.value)),p=C(()=>t.value-g.value+1),n=C({get(){return v.clicksContext.current>t.value?-1:v.clicksContext.current},set(d){v.clicksContext.current=d}}),w=C(()=>O(g.value,t.value+1));function h(){v.readonly||(n.value<0||n.value>t.value)&&(n.value=0)}return(d,s)=>{const m=X;return x(),f("div",{class:k(["flex gap-1 items-center select-none",p.value&&v.clicksContext.isMounted?"":"op50"]),title:`Clicks in this slide: ${p.value}`},[u("div",Y,[P(m,{"text-sm":"",op50:""}),n.value>=0&&n.value!==V(H)&&c.active?(x(),f(A,{key:0},[s[2]||(s[2]=u("div",{"flex-auto":""},null,-1)),u("span",Z,y(n.value),1),s[3]||(s[3]=u("span",{op25:"","text-sm":""},"/",-1)),u("span",ee,y(t.value),1)],64)):(x(),f("div",te,y(t.value),1))]),u("div",oe,[(x(!0),f(A,null,K(w.value,a=>(x(),f("div",{key:a,border:"y main","of-hidden":"",relative:"",class:k([a===0?"rounded-l border-l":"",a===t.value?"rounded-r border-r":""]),style:B({width:p.value>0?`${1/p.value*100}%`:"100%"})},[u("div",{absolute:"","inset-0":"",class:k(a<=n.value&&c.active?"bg-primary op15":"")},null,2),u("div",{class:k([+a==+n.value&&c.active?"text-primary font-bold op100 border-primary":"op30 border-main",a===0?"rounded-l":"",a===t.value?"rounded-r":"border-r-2"]),"w-full":"","h-full":"","text-xs":"",flex:"","items-center":"","justify-center":"","z-1":""},y(a),3)],6))),128)),R(u("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),class:k(["range",c.readonly?"pointer-events-none":""]),type:"range",min:g.value,max:t.value,step:1,absolute:"","inset-0":"","z-10":"",op0:"",style:B({"--thumb-width":`${1/(p.value+1)*100}%`}),onMousedown:h,onFocus:s[1]||(s[1]=a=>{var _;return(_=a.currentTarget)==null?void 0:_.blur()})},null,46,le),[[j,n.value]])])],10,W)}}}),ce=U(ne,[["__scopeId","data-v-ef0c5640"]]);export{ce as C,re as _};
